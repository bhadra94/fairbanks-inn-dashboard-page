<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fairbanks Inn 2021-2025 Analytics Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f1e 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .dashboard {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
            animation: slideDown 0.8s ease-out;
        }

        .header h1 {
            font-size: 3rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
            letter-spacing: -1px;
        }

        .header p {
            color: #9ca3af;
            font-size: 1.2rem;
        }

        .year-selector {
            text-align: center;
            margin-bottom: 2rem;
            animation: fadeInUp 0.4s ease-out;
        }

        .year-buttons {
            display: inline-flex;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 0.5rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .year-btn {
            padding: 0.75rem 2rem;
            border: none;
            background: transparent;
            color: #9ca3af;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .year-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .year-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            animation: fadeInUp 0.8s ease-out;
            animation-fill-mode: both;
            position: relative;
            overflow: hidden;
        }

        .metric-card:nth-child(1) { animation-delay: 0.1s; }
        .metric-card:nth-child(2) { animation-delay: 0.2s; }
        .metric-card:nth-child(3) { animation-delay: 0.3s; }
        .metric-card:nth-child(4) { animation-delay: 0.4s; }

        .metric-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.5rem;
        }

        .metric-label {
            color: #9ca3af;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-change {
            font-size: 0.85rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
        }

        .metric-change.positive {
            color: #34d399;
        }

        .metric-change.negative {
            color: #ef4444;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            animation: fadeInUp 0.8s ease-out 0.5s;
            animation-fill-mode: both;
        }

        .chart-title {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            color: #e0e0e0;
            text-align: center;
        }

        .chart-wrapper {
            position: relative;
            height: 400px;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .insight-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            animation: fadeInUp 0.8s ease-out 0.8s;
            animation-fill-mode: both;
            transition: all 0.3s ease;
        }

        .insight-card:hover {
            border-color: rgba(102, 126, 234, 0.5);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.2);
        }

        .insight-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .insight-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: #e0e0e0;
        }

        .insight-text {
            color: #9ca3af;
            line-height: 1.6;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 400px;
        }

        .loading::after {
            content: '';
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .comparison-table {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            animation: fadeInUp 0.8s ease-out 0.9s;
            animation-fill-mode: both;
        }

        .comparison-table h3 {
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: #e0e0e0;
        }

        .comparison-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comparison-table th {
            color: #9ca3af;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.85rem;
            letter-spacing: 1px;
        }

        .comparison-table td {
            color: #e0e0e0;
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .percent-change {
            font-size: 0.85rem;
            margin-left: 0.5rem;
        }

        .percent-change.positive {
            color: #34d399;
        }

        .percent-change.negative {
            color: #ef4444;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <h1>Fairbanks Inn Analytics</h1>
            <p>2021-2025 Performance Dashboard</p>
        </div>

        <div class="year-selector">
            <div class="year-buttons">
                <button class="year-btn" onclick="showYear(2021)">2021</button>
                <button class="year-btn" onclick="showYear(2022)">2022</button>
                <button class="year-btn" onclick="showYear(2023)">2023</button>
                <button class="year-btn active" onclick="showYear(2024)">2024</button>
                <button class="year-btn" onclick="showYear(2025)">2025 YTD</button>
                <button class="year-btn" onclick="showComparison()">Compare</button>
            </div>
            <div class="footer-credit" style="text-align: center; margin-top: 3rem; padding: 2rem 0; color: #6b7280; font-size: 0.9rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
            Designed & Developed by Bhadra Parekh
        </div>
        </div>

        <div class="metrics-grid" id="metricsGrid">
            <div class="metric-card">
                <div class="metric-value" id="totalRevenue">$1.37M</div>
                <div class="metric-label">Total Revenue</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="totalReservations">3,388</div>
                <div class="metric-label">Reservations</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="avgADR">$103.25</div>
                <div class="metric-label">Average ADR</div>
            </div>
            <div class="metric-card">
                <div class="metric-value" id="avgOccupancy">73.5%</div>
                <div class="metric-label">Avg Occupancy Rate</div>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title" id="revenueChartTitle">Monthly Revenue & ADR Trends - 2024</h2>
            <div class="chart-wrapper">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title" id="occupancyChartTitle">Seasonal Occupancy Patterns - 2024</h2>
            <div class="chart-wrapper">
                <canvas id="occupancyChart"></canvas>
            </div>
        </div>

        <div class="chart-container">
            <h2 class="chart-title" id="businessMixTitle">Business Mix by Source - 2024</h2>
            <div class="chart-wrapper">
                <canvas id="businessMixChart"></canvas>
            </div>
        </div>

        <div class="comparison-table" id="comparisonTable" style="display: none;">
            <h3>Year-over-Year Comparison</h3>
            <table>
                <thead>
                    <tr>
                        <th>Metric</th>
                        <th>2021</th>
                        <th>2022</th>
                        <th>2023</th>
                        <th>2024</th>
                        <th>2025 YTD</th>
                        <th>Change (21-22)</th>
                        <th>Change (22-23)</th>
                        <th>Change (23-24)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Total Revenue</td>
                        <td>$1,882,851</td>
                        <td>$2,229,125</td>
                        <td>$1,888,640</td>
                        <td>$1,368,413</td>
                        <td>$722,044</td>
                        <td><span class="percent-change positive">+18.4%</span></td>
                        <td><span class="percent-change negative">-15.3%</span></td>
                        <td><span class="percent-change negative">-27.5%</span></td>
                    </tr>
                    <tr>
                        <td>Reservations</td>
                        <td>3,228</td>
                        <td>1,236</td>
                        <td>2,902</td>
                        <td>3,388</td>
                        <td>1,905</td>
                        <td><span class="percent-change negative">-61.7%</span></td>
                        <td><span class="percent-change positive">+134.8%</span></td>
                        <td><span class="percent-change positive">+16.7%</span></td>
                    </tr>
                    <tr>
                        <td>Average ADR</td>
                        <td>$132.59</td>
                        <td>$152.81</td>
                        <td>$153.47</td>
                        <td>$103.25</td>
                        <td>$96.30</td>
                        <td><span class="percent-change positive">+15.3%</span></td>
                        <td><span class="percent-change positive">+0.4%</span></td>
                        <td><span class="percent-change negative">-32.8%</span></td>
                    </tr>
                    <tr>
                        <td>Room Nights</td>
                        <td>14,525</td>
                        <td>15,209</td>
                        <td>12,308</td>
                        <td>13,252</td>
                        <td>7,497</td>
                        <td><span class="percent-change positive">+4.7%</span></td>
                        <td><span class="percent-change negative">-19.1%</span></td>
                        <td><span class="percent-change positive">+7.7%</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="insights-grid" id="insightsGrid">
            <div class="insight-card">
                <div class="insight-icon">❄️</div>
                <div class="insight-title">Winter Peak Performance</div>
                <div class="insight-text">January and February drive 24.5% of annual revenue with premium ADRs exceeding $130. This winter dependency suggests strong seasonal tourism or corporate demand.</div>
            </div>
            <div class="insight-card">
                <div class="insight-icon">🏢</div>
                <div class="insight-title">Corporate Base Business</div>
                <div class="insight-text">ECONOMIC SERVICE provides 70-80% occupancy year-round at $80 ADR, creating stable but low-margin foundation. Opportunity exists to optimize this mix during peak seasons.</div>
            </div>
            <div class="insight-card">
                <div class="insight-icon">📈</div>
                <div class="insight-title">Revenue Optimization Potential</div>
                <div class="insight-text">With ADR gaps between corporate ($80) and leisure ($130+) rates, strategic yield management could increase revenue by 15-20% during high-demand periods.</div>
            </div>
        </div>
    </div>

    <script>
        // Chart configuration with glassmorphism effect
        Chart.defaults.color = '#9ca3af';
        Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';

        // Data for all years
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        // 2021 data (extracted from the second document)
        const data2021 = {
            revenue: [126543.89, 119204.47, 133442.95, 146070.33, 177150.39, 167807.73, 184143.23, 173186.88, 176221.23, 194248.60, 146813.95, 133517.70],
            adr: [98.55, 102.23, 104.33, 127.13, 150.25, 154.38, 151.43, 146.52, 148.96, 155.77, 126.45, 112.39],
            roomNights: [1284, 1166, 1279, 1149, 1179, 1087, 1216, 1182, 1183, 1247, 1161, 1188],
            reservations: [169, 161, 198, 179, 218, 240, 385, 417, 401, 475, 208, 177],
            totalRevenue: 1882851.12,
            totalReservations: 3228,
            avgADR: 132.59,
            totalRoomNights: 14525
        };
        
        // 2022 data (extracted from the second document)
        const data2022 = {
            revenue: [130894.75, 125665.70, 193447.82, 205179.91, 215604.00, 210490.00, 210888.00, 203477.05, 201502.78, 241399.98, 224878.48, 215696.48],
            adr: [110.18, 112.60, 148.35, 157.95, 159.00, 159.34, 154.61, 154.62, 171.05, 183.85, 177.49, 166.30],
            roomNights: [1188, 1116, 1304, 1299, 1356, 1321, 1364, 1316, 1178, 1313, 1267, 1297],
            reservations: [162, 159, 116, 100, 97, 92, 46, 48, 102, 148, 86, 80],
            totalRevenue: 2229124.94,
            totalReservations: 1236,
            avgADR: 152.81,
            totalRoomNights: 15209
        };
        
        // 2023 data (extracted from the document)
        const data2023 = {
            revenue: [215923.34, 200182.20, 204523.21, 195848.04, 205182.34, 124668.01, 142048.26, 173039.44, 143628.70, 158989.49, 108136.63, 147796.56],
            adr: [167.25, 184.33, 165.87, 161.86, 162.59, 156.03, 150.16, 148.79, 153.78, 154.06, 132.20, 130.79],
            roomNights: [1291, 1086, 1233, 1210, 1262, 799, 946, 1163, 934, 1032, 818, 1130],
            reservations: [82, 88, 119, 89, 135, 229, 420, 487, 390, 456, 232, 285],
            totalRevenue: 1888640.22,
            totalReservations: 2902,
            avgADR: 153.47,
            totalRoomNights: 12308
        };

        // 2024 data
        const data2024 = {
            revenue: [173160.75, 161818.73, 93380.25, 94070.66, 90755.87, 105619.15, 116701.99, 115264.03, 99154.69, 136100.71, 78718.60, 103767.26],
            adr: [132.59, 134.07, 83.38, 85.29, 84.74, 90.04, 98.07, 102.09, 105.26, 143.87, 90.90, 86.33],
            occupancy: [84.1, 85.9, 72.1, 73.5, 68.9, 78.2, 76.6, 72.7, 62.8, 60.9, 57.7, 77.4],
            totalRevenue: 1368412.69,
            totalReservations: 3388,
            avgADR: 103.25,
            avgOccupancy: 73.5
        };

        // 2025 data (Jan-Nov from the report)
        const data2025 = {
            revenue: [111988.91, 103149.79, 104639.36, 87911.63, 89587.80, 85023.18, 89743.46, 26813.41, 9423.11, 13373.48, 388.80, 0],
            adr: [88.67, 92.68, 89.59, 87.39, 92.55, 93.64, 103.99, 139.65, 154.48, 252.33, 129.60, 0],
            occupancy: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], // Occupancy not provided in 2025 data
            totalRevenue: 722043.93,
            totalReservations: 1905,
            avgADR: 96.30,
            avgOccupancy: 'N/A',
            roomNights: 7497,
            reservations: [275, 264, 249, 224, 254, 262, 289, 110, 49, 25, 1, 0]
        };

        let currentYear = 2024;
        let revenueChart, occupancyChart, businessMixChart;

        function formatCurrency(value) {
            if (value >= 1000000) {
                return '$' + (value / 1000000).toFixed(2) + 'M';
            } else if (value >= 1000) {
                return '$' + (value / 1000).toFixed(0) + 'K';
            }
            return '$' + value.toFixed(2);
        }

        function updateMetrics(year) {
            let data;
            if (year === 2021) {
                data = data2021;
            } else if (year === 2022) {
                data = data2022;
            } else if (year === 2023) {
                data = data2023;
            } else if (year === 2024) {
                data = data2024;
            } else {
                data = data2025;
            }
            
            document.getElementById('totalRevenue').textContent = formatCurrency(data.totalRevenue);
            document.getElementById('totalReservations').textContent = data.totalReservations.toLocaleString();
            document.getElementById('avgADR').textContent = '$' + data.avgADR.toFixed(2);
            
            if (year === 2021 || year === 2022 || year === 2023) {
                // Calculate occupancy for 2021, 2022 and 2023 (assuming 50 rooms and 365 days)
                const avgOccupancy = (data.totalRoomNights / (50 * 365) * 100).toFixed(1);
                document.getElementById('avgOccupancy').textContent = avgOccupancy + '%';
            } else {
                document.getElementById('avgOccupancy').textContent = data.avgOccupancy === 'N/A' ? 'N/A' : data.avgOccupancy + '%';
            }
        }

        function createRevenueChart(year) {
            const ctx = document.getElementById('revenueChart').getContext('2d');
            let data;
            if (year === 2021) {
                data = data2021;
            } else if (year === 2022) {
                data = data2022;
            } else if (year === 2023) {
                data = data2023;
            } else if (year === 2024) {
                data = data2024;
            } else {
                data = data2025;
            }
            
            if (revenueChart) {
                revenueChart.destroy();
            }

            const datasets = [{
                label: 'Revenue ($)',
                data: data.revenue,
                borderColor: '#667eea',
                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                yAxisID: 'y',
                tension: 0.4,
                fill: true,
                pointRadius: 6,
                pointHoverRadius: 8,
                pointBackgroundColor: '#667eea',
                borderWidth: 3
            }, {
                label: 'ADR ($)',
                data: data.adr,
                borderColor: '#764ba2',
                backgroundColor: 'rgba(118, 75, 162, 0.1)',
                yAxisID: 'y1',
                tension: 0.4,
                fill: true,
                pointRadius: 6,
                pointHoverRadius: 8,
                pointBackgroundColor: '#764ba2',
                borderWidth: 3
            }];

            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 20,
                                font: { size: 14 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 46, 0.9)',
                            padding: 15,
                            borderColor: 'rgba(102, 126, 234, 0.3)',
                            borderWidth: 1,
                            titleFont: { size: 16 },
                            bodyFont: { size: 14 },
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (context.parsed.y !== null) {
                                        label += ': $' + context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'k';
                                }
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: {
                                drawOnChartArea: false,
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    }
                }
            });
        }

        function createOccupancyChart(year) {
            const ctx = document.getElementById('occupancyChart').getContext('2d');
            let data;
            if (year === 2021) {
                data = data2021;
            } else if (year === 2022) {
                data = data2022;
            } else if (year === 2023) {
                data = data2023;
            } else if (year === 2024) {
                data = data2024;
            } else {
                data = data2025;
            }
            
            if (occupancyChart) {
                occupancyChart.destroy();
            }

            if (year === 2025 || year === 2023 || year === 2022 || year === 2021) {
                // For 2025, 2023, 2022, and 2021, show reservations/room nights instead since occupancy data is not available
                const chartData = (year === 2023 || year === 2022 || year === 2021) ? data.roomNights : data.reservations;
                const chartLabel = (year === 2023 || year === 2022 || year === 2021) ? 'Room Nights' : 'Reservations';
                
                occupancyChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: months,
                        datasets: [{
                            label: chartLabel,
                            data: chartData,
                            backgroundColor: 'rgba(102, 126, 234, 0.6)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 2,
                            borderRadius: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(26, 26, 46, 0.9)',
                                padding: 15,
                                callbacks: {
                                    label: function(context) {
                                        return chartLabel + ': ' + context.parsed.y.toLocaleString();
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.05)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
                document.getElementById('occupancyChartTitle').textContent = `Monthly ${chartLabel} - ${year}`;
            } else {
                // Original occupancy chart for 2024
                occupancyChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: months,
                        datasets: [{
                            label: 'Occupancy %',
                            data: data.occupancy,
                            backgroundColor: function(context) {
                                const value = context.parsed.y;
                                if (value >= 80) return 'rgba(34, 197, 94, 0.6)';
                                if (value >= 70) return 'rgba(251, 191, 36, 0.6)';
                                return 'rgba(239, 68, 68, 0.6)';
                            },
                            borderColor: function(context) {
                                const value = context.parsed.y;
                                if (value >= 80) return 'rgba(34, 197, 94, 1)';
                                if (value >= 70) return 'rgba(251, 191, 36, 1)';
                                return 'rgba(239, 68, 68, 1)';
                            },
                            borderWidth: 2,
                            borderRadius: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(26, 26, 46, 0.9)',
                                padding: 15,
                                callbacks: {
                                    label: function(context) {
                                        return 'Occupancy: ' + context.parsed.y.toFixed(1) + '%';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.05)'
                                },
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
                document.getElementById('occupancyChartTitle').textContent = 'Seasonal Occupancy Patterns - 2024';
            }
        }

        function createBusinessMixChart(year) {
            const ctx = document.getElementById('businessMixChart').getContext('2d');
            
            if (businessMixChart) {
                businessMixChart.destroy();
            }

            let chartData, labels;
            
            if (year === 2021) {
                // Calculate from 2021 data - based on total reservations
                labels = ['Walk In', 'Past Guest', 'Internet', 'OTAs (Booking/Expedia)', 'Other'];
                chartData = [59.6, 7.5, 14.4, 16.2, 2.3]; // Calculated percentages from the data
            } else if (year === 2022) {
                // Calculate from 2022 data - based on reservations
                labels = ['Walk In', 'Past Guest', 'Internet', 'Webrezpro/stjay.com'];
                chartData = [73.3, 10.1, 13.3, 3.3]; // Calculated percentages from the data
            } else if (year === 2023) {
                // Calculate from 2023 data - aggregate sources
                labels = ['Walk In', 'Past Guest', 'Internet', 'OTAs (Booking/Expedia)', 'Other'];
                chartData = [58.1, 12.2, 16.8, 11.7, 1.2]; // Calculated percentages from the data
            } else if (year === 2024) {
                labels = ['Walk-In', 'Past Guest', 'OTAs', 'Direct Website', 'Corporate (ECONOMIC SERVICE)'];
                chartData = [35, 20, 15, 5, 25];
            } else {
                // For 2025, calculate actual percentages from the data
                const sources = {
                    'Walk In': 442,
                    'Past Guest': 488,
                    'Expedia': 561,
                    'Booking.com': 206,
                    'Internet': 300,
                    'Webrezpro/stjay.com': 102,
                    'Welcome Center': 56,
                    'REFERRAL': 2
                };
                
                const total = Object.values(sources).reduce((a, b) => a + b, 0);
                labels = Object.keys(sources);
                chartData = Object.values(sources).map(v => ((v / total) * 100).toFixed(1));
            }

            businessMixChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)',
                            'rgba(251, 191, 36, 0.8)',
                            'rgba(34, 197, 94, 0.8)',
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(236, 72, 153, 0.8)',
                            'rgba(147, 51, 234, 0.8)'
                        ],
                        borderColor: 'rgba(255, 255, 255, 0.1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                padding: 20,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 46, 0.9)',
                            padding: 15,
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    }
                }
            });
        }

        function showYear(year) {
            currentYear = year;
            
            // Update active button
            document.querySelectorAll('.year-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Hide comparison table
            document.getElementById('comparisonTable').style.display = 'none';
            
            // Update metrics
            updateMetrics(year);
            
            // Update charts
            createRevenueChart(year);
            createOccupancyChart(year);
            createBusinessMixChart(year);
            
            // Update titles
            document.getElementById('revenueChartTitle').textContent = `Monthly Revenue & ADR Trends - ${year}`;
            document.getElementById('businessMixTitle').textContent = `Business Mix by Source - ${year}`;
            
            // Update insights based on year
            if (year === 2021) {
                document.getElementById('insightsGrid').innerHTML = `
                    <div class="insight-card">
                        <div class="insight-icon">🏆</div>
                        <div class="insight-title">Pre-Peak Performance</div>
                        <div class="insight-text">2021 revenue of $1.88M set the foundation for 2022's record year. Average ADR of $132.59 shows healthy pricing power before the 2022 surge.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🏢</div>
                        <div class="insight-title">ECONOMIC SERVICE Growth</div>
                        <div class="insight-text">Corporate account ECONOMIC SERVICE emerged as the dominant revenue driver in 2021, establishing the foundation for future years' stable occupancy.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">☀️</div>
                        <div class="insight-title">Summer Peak Season</div>
                        <div class="insight-text">July-October showed exceptional strength with revenues exceeding $170K monthly and ADRs above $145. Summer tourism drove premium pricing power.</div>
                    </div>
                `;
            } else if (year === 2022) {
                document.getElementById('insightsGrid').innerHTML = `
                    <div class="insight-card">
                        <div class="insight-icon">🚀</div>
                        <div class="insight-title">Record-Breaking Year</div>
                        <div class="insight-text">2022 achieved highest revenue of $2.23M with exceptional ADR averaging $152.81. This represents the peak performance period for the property.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🏢</div>
                        <div class="insight-title">ECONOMIC SERVICE Dominance</div>
                        <div class="insight-text">Corporate account ECONOMIC SERVICE drove majority of business throughout 2022, providing consistent occupancy and revenue stability across all months.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">📊</div>
                        <div class="insight-title">Strong Spring Performance</div>
                        <div class="insight-text">April-May showed exceptional strength with revenues exceeding $205K and $215K respectively, driven by high ADRs and strong corporate demand.</div>
                    </div>
                `;
            } else if (year === 2023) {
                document.getElementById('insightsGrid').innerHTML = `
                    <div class="insight-card">
                        <div class="insight-icon">💰</div>
                        <div class="insight-title">Peak Performance Year</div>
                        <div class="insight-text">2023 showed strong performance with $1.89M in revenue and consistently high ADRs averaging $153.47. Winter months performed exceptionally well with ADRs exceeding $165.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🏢</div>
                        <div class="insight-title">ECONOMIC SERVICE Foundation</div>
                        <div class="insight-text">Corporate account ECONOMIC SERVICE provided significant base business throughout 2023, contributing to stable occupancy levels across all months.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🚶</div>
                        <div class="insight-title">Walk-In Dominance</div>
                        <div class="insight-text">Walk-in guests represented the largest segment at 58% of reservations, indicating strong location visibility and spontaneous demand patterns.</div>
                    </div>
                `;
            } else if (year === 2025) {
                document.getElementById('insightsGrid').innerHTML = `
                    <div class="insight-card">
                        <div class="insight-icon">📉</div>
                        <div class="insight-title">Revenue Decline Alert</div>
                        <div class="insight-text">2025 YTD revenue is down 16.8% compared to same period in 2024. This decline is driven by lower ADRs across all segments, particularly in winter months.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🏢</div>
                        <div class="insight-title">ECONOMIC SERVICE Dominance</div>
                        <div class="insight-text">Corporate account ECONOMIC SERVICE continues to provide stable occupancy at $80 ADR, but its proportion has increased, pulling down overall revenue per room.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🎯</div>
                        <div class="insight-title">Direct Booking Opportunity</div>
                        <div class="insight-text">OTAs (Expedia & Booking.com) represent 36% of reservations. Shifting more bookings to direct channels could improve profit margins significantly.</div>
                    </div>
                `;
            } else {
                document.getElementById('insightsGrid').innerHTML = `
                    <div class="insight-card">
                        <div class="insight-icon">❄️</div>
                        <div class="insight-title">Winter Peak Performance</div>
                        <div class="insight-text">January and February drive 24.5% of annual revenue with premium ADRs exceeding $130. This winter dependency suggests strong seasonal tourism or corporate demand.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">🏢</div>
                        <div class="insight-title">Corporate Base Business</div>
                        <div class="insight-text">ECONOMIC SERVICE provides 70-80% occupancy year-round at $80 ADR, creating stable but low-margin foundation. Opportunity exists to optimize this mix during peak seasons.</div>
                    </div>
                    <div class="insight-card">
                        <div class="insight-icon">📈</div>
                        <div class="insight-title">Revenue Optimization Potential</div>
                        <div class="insight-text">With ADR gaps between corporate ($80) and leisure ($130+) rates, strategic yield management could increase revenue by 15-20% during high-demand periods.</div>
                    </div>
                `;
            }
        }

        function showComparison() {
            // Update active button
            document.querySelectorAll('.year-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show comparison table
            document.getElementById('comparisonTable').style.display = 'block';
            
            // Create comparison chart showing all five years
            const ctx = document.getElementById('revenueChart').getContext('2d');
            
            if (revenueChart) {
                revenueChart.destroy();
            }
            
            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: '2021 Revenue',
                        data: data2021.revenue,
                        borderColor: '#ff8c00',
                        backgroundColor: 'rgba(255, 140, 0, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#ff8c00',
                        borderWidth: 3
                    }, {
                        label: '2022 Revenue',
                        data: data2022.revenue,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#ef4444',
                        borderWidth: 3
                    }, {
                        label: '2023 Revenue',
                        data: data2023.revenue,
                        borderColor: '#34d399',
                        backgroundColor: 'rgba(52, 211, 153, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#34d399',
                        borderWidth: 3
                    }, {
                        label: '2024 Revenue',
                        data: data2024.revenue,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#667eea',
                        borderWidth: 3
                    }, {
                        label: '2025 Revenue',
                        data: data2025.revenue,
                        borderColor: '#764ba2',
                        backgroundColor: 'rgba(118, 75, 162, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#764ba2',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 20,
                                font: { size: 14 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 46, 0.9)',
                            padding: 15,
                            borderColor: 'rgba(102, 126, 234, 0.3)',
                            borderWidth: 1,
                            titleFont: { size: 16 },
                            bodyFont: { size: 14 },
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (context.parsed.y !== null) {
                                        label += ': $' + context.parsed.y.toLocaleString();
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + (value / 1000) + 'k';
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    }
                }
            });
            
            document.getElementById('revenueChartTitle').textContent = 'Revenue Comparison: 2021-2025';
            
            // Create ADR comparison chart
            const ctx2 = document.getElementById('occupancyChart').getContext('2d');
            
            if (occupancyChart) {
                occupancyChart.destroy();
            }
            
            occupancyChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: '2021 ADR',
                        data: data2021.adr,
                        borderColor: '#ff8c00',
                        backgroundColor: 'rgba(255, 140, 0, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#ff8c00',
                        borderWidth: 3
                    }, {
                        label: '2022 ADR',
                        data: data2022.adr,
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#ef4444',
                        borderWidth: 3
                    }, {
                        label: '2023 ADR',
                        data: data2023.adr,
                        borderColor: '#34d399',
                        backgroundColor: 'rgba(52, 211, 153, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#34d399',
                        borderWidth: 3
                    }, {
                        label: '2024 ADR',
                        data: data2024.adr,
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#667eea',
                        borderWidth: 3
                    }, {
                        label: '2025 ADR',
                        data: data2025.adr,
                        borderColor: '#764ba2',
                        backgroundColor: 'rgba(118, 75, 162, 0.1)',
                        tension: 0.4,
                        fill: false,
                        pointRadius: 4,
                        pointHoverRadius: 6,
                        pointBackgroundColor: '#764ba2',
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 20,
                                font: { size: 14 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(26, 26, 46, 0.9)',
                            padding: 15,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (context.parsed.y !== null) {
                                        label += ': $' + context.parsed.y.toFixed(2);
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                callback: function(value) {
                                    return '$' + value;
                                }
                            }
                        },
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    }
                }
            });
            
            document.getElementById('occupancyChartTitle').textContent = 'ADR Comparison: 2021-2025';
            document.getElementById('businessMixTitle').textContent = 'Select a year to view business mix';
            
            if (businessMixChart) businessMixChart.destroy();
        }

        // Initialize with 2024 data
        updateMetrics(2024);
        createRevenueChart(2024);
        createOccupancyChart(2024);
        createBusinessMixChart(2024);
    </script>
</body>
</html>
